

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Hooks &mdash; tackle-box 0.1.0-alpha.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Config (0.7.0+)" href="user_config.html" />
    <link rel="prev" title="Advanced Usage" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> tackle-box
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0-alpha.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../README.html">Tackle Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos.html">Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Additional Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial1.html">Getting to Know Tackle Box</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced Usage</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#context-hooks">Context Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-pre-post-generate-hooks">Using Pre/Post-Generate Hooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#writing-hooks">Writing hooks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#exit-with-an-appropriate-status">Exit with an appropriate status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#current-working-directory">Current working directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#template-variables-are-rendered-in-the-script">Template variables are rendered in the script</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example-validating-template-variables">Example: Validating template variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-conditional-files-directories">Example: Conditional files / directories</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="user_config.html">User Config (0.7.0+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="calling_from_python.html">Calling Cookiecutter Functions From Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="injecting_context.html">Injecting Extra Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="suppressing_prompts.html">Suppressing Command-Line Prompts</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates_in_context.html">Templates in Context Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="private_variables.html">Private Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="copy_without_render.html">Copy without Render</a></li>
<li class="toctree-l2"><a class="reference internal" href="replay.html">Replay Project Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli_options.html">Command Line Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="choice_variables.html">Choice Variables (1.1+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dict_variables.html">Dictionary Variables (1.5+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="template_extensions.html">Template Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="directories.html">Organizing cookiecutters in directories (1.7+)</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_line_characters.html">Working with line-ends special symbols LF/CRLF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tackle.providers.html">tackle.providers package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tackle.html">tackle package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tackle.cli.html">tackle.cli package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tackle.parser.html">tackle.parser package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tackle.render.html">tackle.render package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tackle.utils.html">tackle.utils package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../HISTORY.html">History</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tackle-box</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Advanced Usage</a> &raquo;</li>
        
      <li>Hooks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/advanced/hooks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hooks">
<span id="user-hooks"></span><h1>Hooks<a class="headerlink" href="#hooks" title="Permalink to this headline">¶</a></h1>
<p>There are two general types of hooks.  Context hooks, hooks that are run from within the calling script, and pre/post-generate hooks that are run before and after files are templated.</p>
</div>
<div class="section" id="context-hooks">
<h1>Context Hooks<a class="headerlink" href="#context-hooks" title="Permalink to this headline">¶</a></h1>
<p>The most useful types of hooks are context hooks as they can be used from within the context file to trigger any kind of action. They are called by specifying a type with in dictionary like so:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">foo</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bar</span>
  <span class="nt">bar_input</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">this</span>
</pre></div>
</div>
<p>For instance, to print out information, one could use the print hook like so:</p>
<div class="highlight-YAML notranslate"><div class="highlight"><pre><span></span><span class="nt">foo</span><span class="p">:</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">print</span>
  <span class="nt">output</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Tackle Box is full of hooks?</span>
</pre></div>
</div>
<p>Each hook exposes a unique interface.</p>
</div>
<div class="section" id="using-pre-post-generate-hooks">
<h1>Using Pre/Post-Generate Hooks<a class="headerlink" href="#using-pre-post-generate-hooks" title="Permalink to this headline">¶</a></h1>
<p>You can have Python or Shell scripts that run before and/or after your project
is generated.</p>
<p>Put them in <cite>hooks/</cite> like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cookiecutter-something/
├── {{cookiecutter.project_slug}}/
├── hooks
│   ├── pre_gen_project.py
│   └── post_gen_project.py
└── tackle.yaml
</pre></div>
</div>
<p>Shell scripts work similarly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cookiecutter-something/
├── {{cookiecutter.project_slug}}/
├── hooks
│   ├── pre_gen_project.sh
│   └── post_gen_project.sh
└── tackle.yaml
</pre></div>
</div>
<p>It shouldn’t be too hard to extend Cookiecutter to work with other types of
scripts too. Pull requests are welcome.</p>
<p>For portability, you should use Python scripts (with extension <cite>.py</cite>) for your
hooks, as these can be run on any platform. However, if you intend for your
template to only be run on a single platform, a shell script (or <cite>.bat</cite> file
on Windows) can be a quicker alternative.</p>
<div class="section" id="writing-hooks">
<h2>Writing hooks<a class="headerlink" href="#writing-hooks" title="Permalink to this headline">¶</a></h2>
<p>Here are some details on how to write pre/post-generate hook scripts.</p>
<div class="section" id="exit-with-an-appropriate-status">
<h3>Exit with an appropriate status<a class="headerlink" href="#exit-with-an-appropriate-status" title="Permalink to this headline">¶</a></h3>
<p>Make sure your hook scripts work in a robust manner. If a hook script fails
(that is, <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.exit">if it finishes with a nonzero exit status</a>), the project
generation will stop and the generated directory will be cleaned up.</p>
</div>
<div class="section" id="current-working-directory">
<h3>Current working directory<a class="headerlink" href="#current-working-directory" title="Permalink to this headline">¶</a></h3>
<p>When the hook scripts script are run, their current working directory is the
root of the generated project. This makes it easy for a post-generate hook to
find generated files using relative paths.</p>
</div>
<div class="section" id="template-variables-are-rendered-in-the-script">
<h3>Template variables are rendered in the script<a class="headerlink" href="#template-variables-are-rendered-in-the-script" title="Permalink to this headline">¶</a></h3>
<p>Just like your project template, Cookiecutter also renders Jinja template
syntax in your scripts. This lets you incorporate Jinja template variables in
your scripts. For example, this line of Python sets <code class="docutils literal notranslate"><span class="pre">foo</span></code> to the
value of the <code class="docutils literal notranslate"><span class="pre">bar</span></code> template variable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="s1">&#39;{{ bar }}&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="example-validating-template-variables">
<h2>Example: Validating template variables<a class="headerlink" href="#example-validating-template-variables" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of a script that validates a template variable
before generating the project, to be used as <code class="docutils literal notranslate"><span class="pre">hooks/pre_gen_project.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="n">MODULE_REGEX</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[_a-zA-Z][_a-zA-Z0-9]+$&#39;</span>

<span class="n">module_name</span> <span class="o">=</span> <span class="s1">&#39;{{ cookiecutter.module_name }}&#39;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">MODULE_REGEX</span><span class="p">,</span> <span class="n">module_name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: </span><span class="si">%s</span><span class="s1"> is not a valid Python module name!&#39;</span> <span class="o">%</span> <span class="n">module_name</span><span class="p">)</span>

    <span class="c1"># exits with status 1 to indicate failure</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="example-conditional-files-directories">
<h2>Example: Conditional files / directories<a class="headerlink" href="#example-conditional-files-directories" title="Permalink to this headline">¶</a></h2>
<p>This is another example of <code class="docutils literal notranslate"><span class="pre">hooks/pre_gen_project.py</span></code> to demonstrate
how to use post-processing hooks to achieve conditional control of files,
directories.</p>
<p>The script ensures that the directory structure is as expected by
removing unwanted files and directories:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">REMOVE_PATHS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;{</span><span class="si">% i</span><span class="s1">f cookiecutter.packaging != &quot;pip&quot; %} requirements.txt {</span><span class="si">% e</span><span class="s1">ndif %}&#39;</span><span class="p">,</span>
    <span class="s1">&#39;{</span><span class="si">% i</span><span class="s1">f cookiecutter.packaging != &quot;poetry&quot; %} poetry.lock {</span><span class="si">% e</span><span class="s1">ndif %}&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">REMOVE_PATHS</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="user_config.html" class="btn btn-neutral float-right" title="User Config (0.7.0+)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="Advanced Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Rob Cannon.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>